var input = `FATTURA,20160104,139.8
FATTURA,20160104,160.92
FATTURA,20160104,65.03
FATTURA,20160104,535.84
FATTURA,20160104,75.68
FATTURA,20160104,332.28
FATTURA,20160105,343.02
FATTURA,20160104,247.84
FATTURA,20160107,75.85
FATTURA,20160107,244.39
FATTURA,20160107,36.16
FATTURA,20160107,34.53
FATTURA,20160108,51.37
FATTURA,20160108,52.24
FATTURA,20160108,113.02
FATTURA,20160108,97.17
FATTURA,20160108,252.7
FATTURA,20160109,55.66
FATTURA,20160111,106.6
FATTURA,20160111,96.94
FATTURA,20160111,109.47
FATTURA,20160112,24.52
FATTURA,20160112,59.62
FATTURA,20160112,42.5
FATTURA,20160112,159.43
FATTURA,20160112,204.55
FATTURA,20160113,57.44
FATTURA,20160113,132.2
FATTURA,20160113,177.71
FATTURA,20160114,235.42
FATTURA,20160114,19.15
FATTURA,20160114,271.83
FATTURA,20160115,252.44
FATTURA,20160115,11.37
FATTURA,20160115,226.79
FATTURA,20160118,244
FATTURA,20160118,32.37
FATTURA,20160119,7.32
FATTURA,20160119,160.65
FATTURA,20160119,26.94
FATTURA,20160120,635.4
FATTURA,20160120,7.38
FATTURA,20160120,13.81
FATTURA,20160120,53.94
FATTURA,20160121,145.85
FATTURA,20160122,35.49
FATTURA,20160123,503.81
FATTURA,20160123,360.17
FATTURA,20160125,294.92
FATTURA,20160125,247.21
FATTURA,20160125,15.4
FATTURA,20160125,22.4
FATTURA,20160126,37.05
FATTURA,20160126,36.88
FATTURA,20160126,2537.6
FATTURA,20160127,7.88
FATTURA,20160127,180.28
FATTURA,20160128,80.15
FATTURA,20160129,68.99
FATTURA,20160129,11.13
FATTURA,20160130,179.19
FATTURA,20160130,108.02
FATTURA,20160201,97.2
FATTURA,20160201,45.46
FATTURA,20160201,242.29
FATTURA,20160202,24.56
FATTURA,20160202,265.84
FATTURA,20160202,30.4
FATTURA,20160202,11.36
FATTURA,20160202,8.64
FATTURA,20160202,62.65
FATTURA,20160203,178.91
FATTURA,20160203,25.72
FATTURA,20160204,217.99
FATTURA,20160204,14.38
FATTURA,20160204,219.6
FATTURA,20160204,160.47
FATTURA,20160205,36.6
FATTURA,20160205,180
FATTURA,20160208,27.67
FATTURA,20160209,71.28
FATTURA,20160210,976
FATTURA,20160211,54.5
FATTURA,20160211,41.36
FATTURA,20160211,56.18
FATTURA,20160211,20.67
FATTURA,20160211,23.47
FATTURA,20160212,56.07
FATTURA,20160212,12.49
FATTURA,20160212,44.73
FATTURA,20160212,330.67
FATTURA,20160215,83.81
FATTURA,20160215,253.03
FATTURA,20160215,148.53
FATTURA,20160215,40.26
FATTURA,20160215,83
FATTURA,20160215,143.81
FATTURA,20160215,40.26
FATTURA,20160216,59.29
FATTURA,20160216,939.4
FATTURA,20160216,261.02
FATTURA,20160217,23.08
FATTURA,20160217,190.15
FATTURA,20160217,18.17
FATTURA,20160218,257.02
FATTURA,20160218,23.18
FATTURA,20160219,122.31
FATTURA,20160219,104.86
FATTURA,20160219,81.41
FATTURA,20160219,194.96
FATTURA,20160219,50.74
FATTURA,20160220,188.69
FATTURA,20160220,98.28
FATTURA,20160220,88.04
FATTURA,20160222,155.51
FATTURA,20160222,18.71
FATTURA,20160222,63.9
FATTURA,20160223,35.9
FATTURA,20160223,84.56
FATTURA,20160224,37.93
FATTURA,20160224,14.47
FATTURA,20160224,142.06
FATTURA,20160225,14.96
FATTURA,20160225,7.06
FATTURA,20160225,50.95
FATTURA,20160225,112.98
FATTURA,20160225,19.76
FATTURA,20160225,917.7
FATTURA,20160301,104.29
FATTURA,20160302,1549.4
FATTURA,20160302,5.65
FATTURA,20160303,73.27
FATTURA,20160303,48.92
FATTURA,20160304,25.99
FATTURA,20160304,41.78
FATTURA,20160304,179.24
FATTURA,20160305,410.63
FATTURA,20160307,16.86
FATTURA,20160307,9.7
FATTURA,20160307,202.03
FATTURA,20160307,274.35
FATTURA,20160308,6.95
FATTURA,20160309,1007.52
FATTURA,20160309,40.8
FATTURA,20160310,106.7
FATTURA,20160310,33.38
FATTURA,20160310,69.5
FATTURA,20160310,3721
FATTURA,20160310,50
FATTURA,20160312,57.3
FATTURA,20160312,15.01
FATTURA,20160314,76.59
FATTURA,20160314,41.13
FATTURA,20160315,549
FATTURA,20160315,64.12
FATTURA,20160315,131.75
FATTURA,20160316,45.47
FATTURA,20160317,26.88
FATTURA,20160317,59.17
FATTURA,20160317,27.67
FATTURA,20160318,272.72
FATTURA,20160318,167.7
FATTURA,20160319,54.49
FATTURA,20160321,69.27
FATTURA,20160321,18.54
FATTURA,20160321,35.79
FATTURA,20160322,75.55
FATTURA,20160323,227.77
FATTURA,20160323,128.48
FATTURA,20160324,88.65
FATTURA,20160329,144.12
FATTURA,20160329,106.62
FATTURA,20160329,223.99
FATTURA,20160330,13.94
FATTURA,20160330,386.63
FATTURA,20160330,116.68
FATTURA,20160330,114.68
FATTURA,20160330,33.84
FATTURA,20160330,374.47
FATTURA,20160330,36.6
FATTURA,20160331,33.2
FATTURA,20160331,370.1
FATTURA,20160331,74.81
FATTURA,20160401,32.2
FATTURA,20160401,50.48
FATTURA,20160404,12.99
FATTURA,20160404,389.46
FATTURA,20160405,54.23
FATTURA,20160405,139.04
FATTURA,20160405,50.3
FATTURA,20160406,79.01
FATTURA,20160406,71.36
FATTURA,20160406,18.03
FATTURA,20160406,410.33
FATTURA,20160407,70.47
FATTURA,20160408,60.9
FATTURA,20160408,65.87
FATTURA,20160408,21.81
FATTURA,20160409,110.58
FATTURA,20160409,60.1
FATTURA,20160409,569.78
FATTURA,20160411,79.06
FATTURA,20160411,47.91
FATTURA,20160411,64.98
FATTURA,20160412,31.78
FATTURA,20160413,50.87
FATTURA,20160413,38.09
FATTURA,20160413,134.63
FATTURA,20160413,671.56
FATTURA,20160414,2443.66
FATTURA,20160414,164.26
FATTURA,20160414,2379
FATTURA,20160415,45.88
FATTURA,20160415,77.6
FATTURA,20160415,147.5
FATTURA,20160415,33.35
FATTURA,20160418,155
FATTURA,20160418,26.45
FATTURA,20160418,80.95
FATTURA,20160418,76.13
FATTURA,20160418,400
FATTURA,20160419,44.84
FATTURA,20160420,14.91
FATTURA,20160420,79.34
FATTURA,20160420,30.3
FATTURA,20160420,113.45
FATTURA,20160420,82.31
FATTURA,20160422,6.65
FATTURA,20160423,50.8
FATTURA,20160423,10.61
FATTURA,20160426,48.65
FATTURA,20160426,11.02
FATTURA,20160426,30.01
FATTURA,20160427,17.86
FATTURA,20160427,59
FATTURA,20160428,195.93
FATTURA,20160428,102.48
FATTURA,20160428,177.56
FATTURA,20160428,19
FATTURA,20160429,47.63
FATTURA,20160430,91.93
FATTURA,20160430,285.97
FATTURA,20160430,10.61
FATTURA,20160502,160
FATTURA,20160502,23.35
FATTURA,20160502,223.7
FATTURA,20160502,11.2
FATTURA,20160504,278.72
FATTURA,20160505,79.96
FATTURA,20160506,89.01
FATTURA,20160506,96.18
FATTURA,20160506,219.28
FATTURA,20160507,25.74
FATTURA,20160509,25.35
FATTURA,20160509,2928
FATTURA,20160509,39.28
FATTURA,20160510,30.48
FATTURA,20160510,291.69
FATTURA,20160511,110.02
FATTURA,20160511,34.16
FATTURA,20160512,89.07
FATTURA,20160512,210
FATTURA,20160512,45.59
FATTURA,20160513,59.96
FATTURA,20160514,83.11
FATTURA,20160516,164.7
FATTURA,20160517,1743.45
FATTURA,20160517,6.76
FATTURA,20160518,206.11
FATTURA,20160518,33.64
FATTURA,20160518,24.01
FATTURA,20160518,358.72
FATTURA,20160518,73.18
FATTURA,20160519,353.98
FATTURA,20160519,58.56
FATTURA,20160519,231.8
FATTURA,20160521,59.51
FATTURA,20160523,631.5
FATTURA,20160523,305.12
FATTURA,20160524,48.6
FATTURA,20160524,120.56
FATTURA,20160524,107.07
FATTURA,20160524,25.03
FATTURA,20160525,72.81
FATTURA,20160525,14.14
FATTURA,20160525,320.86
FATTURA,20160525,70.37
FATTURA,20160525,36.39
FATTURA,20160525,129.54
FATTURA,20160526,116.92
FATTURA,20160526,17.37
FATTURA,20160526,316.65
FATTURA,20160526,68.32
FATTURA,20160526,44.49
FATTURA,20160526,30.83
FATTURA,20160526,14.81
FATTURA,20160527,1225.14
FATTURA,20160528,32.53
FATTURA,20160530,29.27
FATTURA,20160530,33.27
FATTURA,20160530,20.13
FATTURA,20160531,45.15
FATTURA,20160531,59.69
FATTURA,20160531,32.1
FATTURA,20160531,53.41
FATTURA,20160531,135.66
FATTURA,20160601,16.73
FATTURA,20160601,308.48
FATTURA,20160601,54.44
FATTURA,20160601,45.25
FATTURA,20160601,9.67
FATTURA,20160601,399.96
FATTURA,20160601,130
FATTURA,20160603,17.82
FATTURA,20160603,8.91
FATTURA,20160603,33.44
FATTURA,20160604,29.65
FATTURA,20160604,421.53
FATTURA,20160604,37.31
FATTURA,20160606,14.86
FATTURA,20160606,65.49
FATTURA,20160606,20.13
FATTURA,20160606,150.76
FATTURA,20160606,13.99
FATTURA,20160606,483.97
FATTURA,20160607,22.3
FATTURA,20160607,172.91
FATTURA,20160608,12.2
FATTURA,20160608,61.24
FATTURA,20160608,72.68
FATTURA,20160609,121.1
FATTURA,20160609,65.1
FATTURA,20160609,177.53
FATTURA,20160609,140.23
FATTURA,20160609,30.07
FATTURA,20160610,4.22
FATTURA,20160610,103.75
FATTURA,20160610,841.8
FATTURA,20160611,55.45
FATTURA,20160613,21.22
FATTURA,20160614,20.01
FATTURA,20160615,99.93
FATTURA,20160615,34.97
FATTURA,20160615,22.44
FATTURA,20160616,38.8
FATTURA,20160616,114.58
FATTURA,20160616,8.26
FATTURA,20160616,22.48
FATTURA,20160616,55.29
FATTURA,20160617,20.34
FATTURA,20160620,45.87
FATTURA,20160620,142.78
FATTURA,20160620,125.29
FATTURA,20160621,116.2
FATTURA,20160621,100.27
FATTURA,20160622,37.93
FATTURA,20160622,85.62
FATTURA,20160622,261.34
FATTURA,20160623,847.99
FATTURA,20160624,23.64
FATTURA,20160624,15.76
FATTURA,20160624,51.41
FATTURA,20160624,114.3
FATTURA,20160624,63.71
FATTURA,20160625,370.59
FATTURA,20160625,49.68
FATTURA,20160627,448.64
FATTURA,20160627,243.34
FATTURA,20160627,118.46
FATTURA,20160627,50.47
FATTURA,20160628,289.82
FATTURA,20160628,70.03
FATTURA,20160628,79.98
FATTURA,20160628,15.13
FATTURA,20160630,74.09
FATTURA,20160630,75.47
FATTURA,20160630,63.94
FATTURA,20160630,1878.35
FATTURA,20160630,19.95
FATTURA,20160701,75.03
FATTURA,20160701,315.06
FATTURA,20160701,29.87
FATTURA,20160701,56.45
FATTURA,20160701,54.46
FATTURA,20160702,178.43
FATTURA,20160702,388.67
FATTURA,20160704,158.04
FATTURA,20160704,174.84
FATTURA,20160706,1394.51
FATTURA,20160706,25.91
FATTURA,20160706,29.57
FATTURA,20160706,48.49
FATTURA,20160706,20.59
FATTURA,20160707,34.17
FATTURA,20160707,65.34
FATTURA,20160707,319.19
FATTURA,20160708,70.94
FATTURA,20160709,88.94
FATTURA,20160711,123.59
FATTURA,20160711,115.95
FATTURA,20160712,90.23
FATTURA,20160712,144.46
FATTURA,20160712,24.07
FATTURA,20160712,50.98
FATTURA,20160712,93.09
FATTURA,20160713,47.99
FATTURA,20160714,25.29
FATTURA,20160714,56.99
FATTURA,20160715,87.39
FATTURA,20160715,76.13
FATTURA,20160715,31.51
FATTURA,20160715,34.95
FATTURA,20160718,450
FATTURA,20160718,667.54
FATTURA,20160718,30.49
FATTURA,20160719,20.4
FATTURA,20160720,44.44
FATTURA,20160720,269.71
FATTURA,20160721,46.66
FATTURA,20160722,891.66
FATTURA,20160722,69.63
FATTURA,20160722,27.49
FATTURA,20160725,2717.86
FATTURA,20160725,396.5
FATTURA,20160725,17.92
FATTURA,20160725,12.74
FATTURA,20160726,38.89
FATTURA,20160726,34.77
FATTURA,20160726,177.47
FATTURA,20160727,114.88
FATTURA,20160727,82.42
FATTURA,20160727,27.97
FATTURA,20160727,11.2
FATTURA,20160727,171.09
FATTURA,20160728,265.72
FATTURA,20160728,15.92
FATTURA,20160728,34.99
FATTURA,20160728,30.09
FATTURA,20160729,16.77
FATTURA,20160729,107.06
FATTURA,20160801,80.37
FATTURA,20160801,100.94
FATTURA,20160801,13.58
FATTURA,20160802,97.4
FATTURA,20160802,2.49
FATTURA,20160803,19.97
FATTURA,20160804,243.57
FATTURA,20160804,296.75
FATTURA,20160804,8.49
FATTURA,20160805,39.88
FATTURA,20160805,34.16
FATTURA,20160805,52.96
FATTURA,20160808,114.19
FATTURA,20160808,25.62
FATTURA,20160824,43.8
FATTURA,20160826,21.31
FATTURA,20160826,7.5
FATTURA,20160830,25.35
FATTURA,20160830,87.94
FATTURA,20160831,52.34
FATTURA,20160831,31.43
FATTURA,20160901,112.96
FATTURA,20160901,85.51
FATTURA,20160901,35.9
FATTURA,20160901,268.52
FATTURA,20160902,40.54
FATTURA,20160903,30
FATTURA,20160903,119.57
FATTURA,20160905,11.57
FATTURA,20160905,1038.95
FATTURA,20160906,18.93
FATTURA,20160906,198.88
FATTURA,20160906,68.3
FATTURA,20160907,558.5
FATTURA,20160907,158.55
FATTURA,20160907,359.9
FATTURA,20160907,22.11
FATTURA,20160907,12.66
FATTURA,20160908,102.22
FATTURA,20160908,40.26
FATTURA,20160908,12.15
FATTURA,20160908,25.38
FATTURA,20160909,36.99
FATTURA,20160909,29.91
FATTURA,20160909,215.32
FATTURA,20160912,12.76
FATTURA,20160912,24
FATTURA,20160913,86.62
FATTURA,20160913,354.78
FATTURA,20160914,423.77
FATTURA,20160914,58.94
FATTURA,20160914,17.63
FATTURA,20160914,45.65
FATTURA,20160915,108.14
FATTURA,20160915,25.64
FATTURA,20160915,28.96
FATTURA,20160916,80.61
FATTURA,20160919,21.74
FATTURA,20160919,53.53
FATTURA,20160919,39.33
FATTURA,20160919,64.68
FATTURA,20160919,43.11
FATTURA,20160920,9.92
FATTURA,20160921,361.18
FATTURA,20160921,19.95
FATTURA,20160921,19.47
FATTURA,20160921,74.15
FATTURA,20160922,55.07
FATTURA,20160922,835.54
FATTURA,20160922,66.78
FATTURA,20160922,24.99
FATTURA,20160923,61.13
FATTURA,20160923,20.87
FATTURA,20160923,4.39
FATTURA,20160923,9.88
FATTURA,20160923,120.01
FATTURA,20160926,117.53
FATTURA,20160926,104.24
FATTURA,20160927,50.52
FATTURA,20160927,142.17
FATTURA,20160928,149.88
FATTURA,20160929,25.45
FATTURA,20160930,32.17
FATTURA,20161001,115.85
FATTURA,20161001,126.78
FATTURA,20161001,38.71
FATTURA,20161001,35.81
FATTURA,20161003,51.7
FATTURA,20161003,58.07
FATTURA,20161003,10.37
FATTURA,20161003,91.66
FATTURA,20161003,161.42
FATTURA,20161004,443.67
FATTURA,20161004,35.79
FATTURA,20161005,253.63
FATTURA,20161005,74.98
FATTURA,20161005,18.43
FATTURA,20161007,29.28
FATTURA,20161010,585.6
FATTURA,20161010,62.56
FATTURA,20161010,183.06
FATTURA,20161010,196.88
FATTURA,20161010,63.26
FATTURA,20161011,97.44
FATTURA,20161012,47.03
FATTURA,20161012,91.76
FATTURA,20161012,21.74
FATTURA,20161012,45.09
FATTURA,20161012,113.61
FATTURA,20161012,240.54
FATTURA,20161012,34.93
FATTURA,20161013,196.71
FATTURA,20161014,111.91
FATTURA,20161014,74.71
FATTURA,20161014,134.36
FATTURA,20161014,20.12
FATTURA,20161014,10.47
FATTURA,20161015,59.83
FATTURA,20161017,15.2
FATTURA,20161017,79.2
FATTURA,20161018,1098.24
FATTURA,20161019,80.52
FATTURA,20161019,149.3
FATTURA,20161020,12.65
FATTURA,20161021,39.97
FATTURA,20161022,122.99
FATTURA,20161024,27.86
FATTURA,20161024,102.14
FATTURA,20161025,53.27
FATTURA,20161025,336.28
FATTURA,20161025,22.51
FATTURA,20161025,195.52
FATTURA,20161025,22.09
FATTURA,20161026,246.27
FATTURA,20161026,9.61
FATTURA,20161027,2884.14
FATTURA,20161027,72.54
FATTURA,20161027,70.49
FATTURA,20161029,332.61
FATTURA,20161029,112.06
FATTURA,20161031,39.54
FATTURA,20161031,346.53
FATTURA,20161031,41.48
FATTURA,20161031,190.19
FATTURA,20161102,178.93
FATTURA,20161102,29.73
FATTURA,20161103,45.77
FATTURA,20161103,286.21
FATTURA,20161103,40.86
FATTURA,20161104,167.36
FATTURA,20161104,89.29
FATTURA,20161105,22.57
FATTURA,20161107,111.02
FATTURA,20161107,2732.8
FATTURA,20161107,41.96
FATTURA,20161107,66.48
FATTURA,20161108,31.1
FATTURA,20161108,28.1
FATTURA,20161109,19.95
FATTURA,20161109,127.6
FATTURA,20161109,85.64
FATTURA,20161110,9.03
FATTURA,20161111,319.7
FATTURA,20161111,121.74
FATTURA,20161111,130.44
FATTURA,20161114,37.83
FATTURA,20161114,117.22
FATTURA,20161114,150.08
FATTURA,20161114,136.88
FATTURA,20161115,72.59
FATTURA,20161116,33.09
FATTURA,20161116,169.35
FATTURA,20161117,18.1
FATTURA,20161117,25.73
FATTURA,20161118,243.78
FATTURA,20161118,1195.6
FATTURA,20161118,2928
FATTURA,20161118,149.11
FATTURA,20161119,65.78
FATTURA,20161119,7.8
FATTURA,20161121,150.19
FATTURA,20161121,43.07
FATTURA,20161121,12.2
FATTURA,20161121,13.68
FATTURA,20161121,142
FATTURA,20161122,38.52
FATTURA,20161123,13.98
FATTURA,20161123,123.72
FATTURA,20161124,44.4
FATTURA,20161124,18.57
FATTURA,20161124,124.42
FATTURA,20161125,2854.8
FATTURA,20161125,338.04
FATTURA,20161125,90.5
FATTURA,20161125,177.47
FATTURA,20161125,179.28
FATTURA,20161126,16.74
FATTURA,20161128,104.68
RICEVUTA,20161128,250
FATTURA,20161128,19.67
FATTURA,20161130,187.93
FATTURA,20161130,75.69
FATTURA,20161130,50
FATTURA,20161201,1230.04
FATTURA,20161201,96.48
FATTURA,20161201,110.41
FATTURA,20161201,167.51
FATTURA,20161201,147.13
FATTURA,20161202,42.09
FATTURA,20161202,177.23
FATTURA,20161202,34.34
FATTURA,20161202,19.78
FATTURA,20161202,147.08
FATTURA,20161202,201.3
FATTURA,20161203,85.11
FATTURA,20161203,35
FATTURA,20161205,94.16
FATTURA,20161205,15.86
FATTURA,20161205,51.72
FATTURA,20161205,88.52
FATTURA,20161205,51.57
FATTURA,20161205,506.37
FATTURA,20161205,29.28
FATTURA,20161205,215.57
FATTURA,20161205,51.57
NOTA.DI.CREDITO,20161206,51.57
FATTURA,20161206,128.66
FATTURA,20161206,21.08
FATTURA,20161206,2854.8
FATTURA,20161207,34.78
FATTURA,20161207,38.47
FATTURA,20161207,130.41
FATTURA,20161209,47.58
FATTURA,20161209,1586
RICEVUTA,20161210,15.55
RICEVUTA,20161210,19.63
RICEVUTA,20161210,34.4
FATTURA,20161210,96.1
FATTURA,20161210,115.02
FATTURA,20161212,841.8
FATTURA,20161212,1903.2
FATTURA,20161212,20.35
FATTURA,20161213,44.54
FATTURA,20161213,30.26
FATTURA,20161214,144.66
FATTURA,20161214,13.15
FATTURA,20161214,257.86
FATTURA,20161215,1752.63
FATTURA,20161216,433.3
FATTURA,20161217,51.5
FATTURA,20161217,113.44
FATTURA,20161217,38.15
FATTURA,20161219,162.08
FATTURA,20161219,91.54
FATTURA,20161219,100
FATTURA,20161219,21
FATTURA,20161219,134.02
FATTURA,20161220,44.52
FATTURA,20161220,147.57
FATTURA,20161220,62.79
FATTURA,20161221,12.76
FATTURA,20161222,225.79
FATTURA,20161222,50.04
FATTURA,20161223,6.83
FATTURA,20161223,55.71
FATTURA,20161227,65.05
FATTURA,20161228,31.35
FATTURA,20161229,272.22
FATTURA,20161229,146.28
FATTURA,20161230,49.15
FATTURA,20161231,39.14
FATTURA,20170102,1164.76
FATTURA,20170102,50.4
FATTURA,20170103,206.06
FATTURA,20170104,263.52
FATTURA,20170104,13.99
FATTURA,20170105,189.23
FATTURA,20170109,20.09
FATTURA,20170109,45.99
FATTURA,20170110,20.18
FATTURA,20170110,50.91
FATTURA,20170110,43.54
FATTURA,20170111,73.26
FATTURA,20170111,73.61
FATTURA,20170112,426.57
FATTURA,20170112,13.99
FATTURA,20170112,44.73
FATTURA,20170112,38.7
FATTURA,20170112,44.9
FATTURA,20170112,78.91
FATTURA,20170113,2928
FATTURA,20170113,108.3
FATTURA,20170113,102.82
FATTURA,20170116,45.37
FATTURA,20170116,95.23
FATTURA,20170116,15.76
FATTURA,20170116,41.24
NOTA.DI.CREDITO,20170116,10.74
FATTURA,20170117,24.99
FATTURA,20170118,39.17
FATTURA,20170119,248.47
FATTURA,20170119,104.36
FATTURA,20170120,189.2
FATTURA,20170120,35.11
FATTURA,20170120,35.05
FATTURA,20170120,178.97
FATTURA,20170123,308.82
FATTURA,20170123,126.23
FATTURA,20170123,8.21
FATTURA,20170123,83.14
FATTURA,20170123,170.43
FATTURA,20170123,88.08
FATTURA,20170124,112.89
FATTURA,20170124,212.77
FATTURA,20170124,25
FATTURA,20170125,350.65
FATTURA,20170125,498.54
FATTURA,20170126,108.71
FATTURA,20170127,385.84
FATTURA,20170127,36.58
FATTURA,20170127,671
FATTURA,20170128,35.48
FATTURA,20170130,35.17
FATTURA,20170130,40.99
FATTURA,20170131,40.41
FATTURA,20170131,109.8
FATTURA,20170201,75.36
FATTURA,20170201,935.5
FATTURA,20170201,73.32
FATTURA,20170202,117.99
FATTURA,20170202,21.96
FATTURA,20170203,50.31
FATTURA,20170203,120.21
FATTURA,20170203,61.27
FATTURA,20170206,146.35
FATTURA,20170206,14.14
FATTURA,20170206,218.14
FATTURA,20170206,30.49
FATTURA,20170206,35.79
FATTURA,20170207,175.52
FATTURA,20170207,29.23
FATTURA,20170208,24.56
FATTURA,20170209,127.25
FATTURA,20170209,6.45
FATTURA,20170209,9.76
FATTURA,20170210,50.57
FATTURA,20170210,180.97
FATTURA,20170210,103.14
FATTURA,20170210,75.27
FATTURA,20170211,100.43
FATTURA,20170211,38.7
FATTURA,20170215,92.78
FATTURA,20170215,150.71
FATTURA,20170215,33.6
FATTURA,20170216,189.84
FATTURA,20170216,119.02
FATTURA,20170217,80.08
FATTURA,20170217,110.93
FATTURA,20170217,40.38
FATTURA,20170220,110.19
FATTURA,20170220,19.72
FATTURA,20170220,125.61
FATTURA,20170220,25.22
FATTURA,20170221,193.99
FATTURA,20170221,14.86
FATTURA,20170222,11.18
FATTURA,20170222,24.09
FATTURA,20170222,1195.6
FATTURA,20170222,114.27
FATTURA,20170222,118.64
FATTURA,20170222,27.23
FATTURA,20170223,177.64
FATTURA,20170223,169.21
FATTURA,20170223,107.13
FATTURA,20170224,622.41
FATTURA,20170224,19.03
FATTURA,20170224,30.26
FATTURA,20170227,305
FATTURA,20170227,107.64
FATTURA,20170227,130
FATTURA,20170228,249.54
FATTURA,20170301,10.35
FATTURA,20170301,16.98
FATTURA,20170301,20
FATTURA,20170301,84.72
FATTURA,20170302,57.02
FATTURA,20170302,33.32
FATTURA,20170302,42.7
FATTURA,20170303,37.47
FATTURA,20170303,6.88
FATTURA,20170306,110.42
FATTURA,20170306,9.49
FATTURA,20170306,53.24
FATTURA,20170306,182.66
FATTURA,20170306,138.01
FATTURA,20170307,33.6
FATTURA,20170307,242.57
FATTURA,20170307,250.83
FATTURA,20170307,1204.26
FATTURA,20170307,24.69
FATTURA,20170308,98.82
FATTURA,20170308,759.95
FATTURA,20170308,129.73
FATTURA,20170309,12.35
FATTURA,20170310,257.8
FATTURA,20170310,325
FATTURA,20170310,85.19
FATTURA,20170310,76.49
FATTURA,20170313,35.5
FATTURA,20170313,890
FATTURA,20170313,168.24
FATTURA,20170313,24.4
FATTURA,20170315,31.51
FATTURA,20170315,69.82
FATTURA,20170320,45.14
FATTURA,20170320,167.99
FATTURA,20170321,270.06
FATTURA,20170321,100.13
FATTURA,20170324,176.39
FATTURA,20170324,245.79
FATTURA,20170324,74.13
FATTURA,20170325,35.36
FATTURA,20170327,11.59
FATTURA,20170327,13.54
FATTURA,20170327,4.88
FATTURA,20170327,50.67
FATTURA,20170328,8.17
FATTURA,20170328,403.17
FATTURA,20170328,49.8
FATTURA,20170328,369.76
FATTURA,20170328,1656.91
FATTURA,20170329,80.78
FATTURA,20170329,148.59
FATTURA,20170329,22.47
FATTURA,20170330,17.57
FATTURA,20170330,70
FATTURA,20170330,60
FATTURA,20170330,494.1
FATTURA,20170331,33.06
FATTURA,20170401,93.33
FATTURA,20170403,51.18
FATTURA,20170403,75.41
FATTURA,20170403,52.73
FATTURA,20170403,54.68
FATTURA,20170403,221.32
FATTURA,20170403,340
FATTURA,20170404,10.98
FATTURA,20170404,18.06
FATTURA,20170405,50.09
FATTURA,20170405,165.26
FATTURA,20170406,70.45
FATTURA,20170406,67.75
FATTURA,20170407,16.69
FATTURA,20170407,154.63
FATTURA,20170410,390.4
FATTURA,20170410,38.48
FATTURA,20170410,65.34
FATTURA,20170411,125.76
FATTURA,20170411,131.11
FATTURA,20170412,47.1
FATTURA,20170412,254.2
FATTURA,20170413,140.69
FATTURA,20170418,26.11
FATTURA,20170418,187.88
FATTURA,20170420,35.6
FATTURA,20170420,26.39
FATTURA,20170421,38.38
FATTURA,20170424,2867
FATTURA,20170424,80.53
FATTURA,20170427,18.46
FATTURA,20170429,2867
FATTURA,20170502,95.39
FATTURA,20170502,84.67
FATTURA,20170502,78.17
FATTURA,20170503,28.34
FATTURA,20170503,142.74
FATTURA,20170503,90.52
FATTURA,20170504,441.03
FATTURA,20170505,841.8
FATTURA,20170505,889.4
FATTURA,20170506,207.4
FATTURA,20170508,80.92
FATTURA,20170509,72.5
FATTURA,20170509,163.81
FATTURA,20170509,26.14
FATTURA,20170510,104.07
FATTURA,20170510,99.23
FATTURA,20170510,226.48
FATTURA,20170510,178.25
FATTURA,20170511,96.08
FATTURA,20170512,20.36
FATTURA,20170513,16.41
FATTURA,20170513,380.85
FATTURA,20170515,347.09
FATTURA,20170515,15.25
FATTURA,20170516,65.16
FATTURA,20170516,89.96
FATTURA,20170517,31.11
FATTURA,20170517,24.67
FATTURA,20170518,75.01
FATTURA,20170519,120.28
FATTURA,20170519,132.16
FATTURA,20170523,62.28
FATTURA,20170524,427
FATTURA,20170524,68.59
FATTURA,20170526,51.96
FATTURA,20170529,85.19
FATTURA,20170529,21.96
FATTURA,20170530,16.01
FATTURA,20170530,218.32
FATTURA,20170531,76.13
FATTURA,20170601,109.85
FATTURA,20170601,1095.44
FATTURA,20170601,196.47
FATTURA,20170605,329.4
FATTURA,20170605,10.25
FATTURA,20170607,122.93
FATTURA,20170607,126.81
FATTURA,20170607,300.11
FATTURA,20170607,135.27
FATTURA,20170608,33.31
FATTURA,20170608,442.53
FATTURA,20170609,47.03
FATTURA,20170609,56.46
FATTURA,20170609,39.65
FATTURA,20170610,25.24
FATTURA,20170612,34.01
FATTURA,20170612,25.6
FATTURA,20170612,15.38
FATTURA,20170612,201.12
FATTURA,20170613,17.2
FATTURA,20170614,30.96
FATTURA,20170614,80.07
FATTURA,20170615,15.25
FATTURA,20170615,70.39
FATTURA,20170619,2867
FATTURA,20170619,65.59
FATTURA,20170619,156.65
FATTURA,20170619,317.4
FATTURA,20170620,129.32
FATTURA,20170620,237.38
FATTURA,20170620,47.97
FATTURA,20170620,8.59
FATTURA,20170620,2760.6
FATTURA,20170622,37.43
FATTURA,20170622,2858.94
FATTURA,20170623,325.36
FATTURA,20170623,190.08
FATTURA,20170624,109.58
FATTURA,20170624,23.64
FATTURA,20170626,65.49
FATTURA,20170626,45.53
FATTURA,20170627,35.09
FATTURA,20170627,158.28
FATTURA,20170628,30.44
FATTURA,20170628,130
FATTURA,20170628,2867
FATTURA,20170701,72.92
FATTURA,20170703,29.33
FATTURA,20170703,56.1
FATTURA,20170704,25.6
FATTURA,20170704,250.72
FATTURA,20170705,491.15
FATTURA,20170706,2845.92
FATTURA,20170706,45.95
FATTURA,20170706,211.44
FATTURA,20170706,22.92
FATTURA,20170707,643.64
FATTURA,20170707,94.98
FATTURA,20170708,187.01
FATTURA,20170708,300.32
FATTURA,20170708,34
FATTURA,20170708,1516.52
FATTURA,20170711,167.19
FATTURA,20170711,183
FATTURA,20170712,45.53
FATTURA,20170713,86.99
FATTURA,20170713,36.6
FATTURA,20170715,28.84
FATTURA,20170715,322.32
FATTURA,20170717,50.07
FATTURA,20170717,333.46
FATTURA,20170717,139.32
FATTURA,20170718,130
FATTURA,20170718,107.85
FATTURA,20170718,153.94
FATTURA,20170718,63.87
FATTURA,20170718,179.72
FATTURA,20170718,129.41
FATTURA,20170719,1941.33
FATTURA,20170719,175.86
FATTURA,20170720,59.35
FATTURA,20170720,348.79
FATTURA,20170720,74.36
FATTURA,20170720,172.45
FATTURA,20170720,60
FATTURA,20170721,153.76
FATTURA,20170722,10.98
FATTURA,20170722,236.18
FATTURA,20170724,147.77
FATTURA,20170724,230.67
FATTURA,20170725,1591.43
FATTURA,20170725,87.46
FATTURA,20170725,43.24
FATTURA,20170725,55.17
FATTURA,20170725,20.56
FATTURA,20170726,121.76`;
var S = ["|",","];

function jobInputSplit ( input_str ) {
    //scrivo il codice di split
    return input_str.split('\n');
}
function keyVal(k,v){  return k+S[0]+v }

function jobMap ( V_In_Map ) {
    
    return V_In_Map.map(function(item){
        //scrivo il codice di map
        var tipoOrdine = item.split(",")[0]
        var data = item.split(",")[1]
        var costo = item.split(",")[2]

        var chiave;
        var valore;
        if(tipoOrdine === "FATTURA" || tipoOrdine === "RICEVUTA"){
            chiave = data.slice(0,6);
            valore = costo;
        }else
        {
            chiave = "NULL";
            valore = 0;
        }
        return keyVal(chiave, valore);
    });
}

function jobReduce ( K_In_Reduce_V_In_Reduce ) {
    
    return K_In_Reduce_V_In_Reduce.map(function (items){
        var K_In_Reduce = items.split(S[0])[0];
    var V_In_Reduce = items.split(S[0])[1].split(S[1]);
    //scrivo il codice di split
    var Reduce = V_In_Reduce.reduce(function (accumulator, item,) {
             return parseInt(accumulator) + parseInt(item);       
    },0);  
    var k_out = K_In_Reduce;
        var v_out = Reduce.toFixed(2);
        return keyVal (k_out,v_out);
    });
}

function merge(v){
    new_v = []
    conc = ''
    for(var i=1; i<=v.length; i++){
        d = v[i-1].split(S[0])
        if(conc.length==0) { conc+= d[1]+S[1]+' '}
        if(i!=v.length){
             d1 = v[i].split(S[0])
             if(d[0] != d1[0]){
                   new_v.push(d[0]+S[0]+conc.substring(0,conc.length-2))
                   conc = ''
                }else{
                   conc+= d1[1]+S[1]+' '
             }
           }else{
             new_v.push(d[0]+S[0]+conc.substring(0,conc.length-2))
        }
     }
     return new_v
 }



var splitted = jobInputSplit(input);
console.log(splitted);
var mapped = jobMap(splitted);
console.log(mapped);
var merged = merge(mapped.sort());
console.log(merged);
var reduced = jobReduce(merged.sort());
console.log(reduced);
input = reduced.join('\n');
console.log(input);
