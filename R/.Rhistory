df <- df %>%
select(anno, mese ,mese_testuale)
#leggo i dati del file
nomeFile="Ordini.csv"
df=read.csv(nomeFile, sep= ",", header= FALSE)
#Aggiungi l’header al dataframe
colnames(df) <- c("tipo","data","costo")
summary(df)
# adding column names
table(df$tipo)
doucmenti_vendita <- subset(df, tipo=="FATTURA" | tipo=="RICEVUTA")
# getting all the dates in format "YYYYMM"
mesi <- substring(doucmenti_vendita$data, 1, 6)
#JOB 1
media_per_mese <- aggregate(doucmenti_vendita$costo, by = list(mesi), FUN = mean)
colnames(media_per_mese) <- c("mesi","vendite_medie")
nomi_mesi <- c("Gen", "Feb", "Mar", "Apr", "Mag", "Giu",
"Lug", "Ago", "Set", "Ott", "Nov", "Dic")
df <- df %>%
mutate(anno = year(ymd(data)),
mese = month(ymd(data)))
df <- df %>%
mutate(mese_testuale = nomi_mesi[mese])
df <- df %>%
mutate(data_formattata = paste(anno, mese_testuale, sep = "-"))
df <- df %>%
select(mesi, vendite ,data_formattata)
#leggo i dati del file
nomeFile="Ordini.csv"
df=read.csv(nomeFile, sep= ",", header= FALSE)
#Aggiungi l’header al dataframe
colnames(df) <- c("tipo","data","costo")
summary(df)
# adding column names
table(df$tipo)
doucmenti_vendita <- subset(df, tipo=="FATTURA" | tipo=="RICEVUTA")
# getting all the dates in format "YYYYMM"
mesi <- substring(doucmenti_vendita$data, 1, 6)
#JOB 1
media_per_mese <- aggregate(doucmenti_vendita$costo, by = list(mesi), FUN = mean)
colnames(media_per_mese) <- c("mesi","vendite_medie")
nomi_mesi <- c("Gen", "Feb", "Mar", "Apr", "Mag", "Giu",
"Lug", "Ago", "Set", "Ott", "Nov", "Dic")
df <- df %>%
mutate(anno = year(ymd(data)),
mese = month(ymd(data)))
df <- df %>%
mutate(mese_testuale = nomi_mesi[mese])
df <- df %>%
mutate(data_formattata = paste(anno, mese_testuale, sep = "-"))
View(df)
media_per_mese <- aggregate(doucmenti_vendita$costo, by = list(mesi), FUN = mean)
colnames(media_per_mese) <- c("mesi","vendite_medie")
nomi_mesi <- c("Gen", "Feb", "Mar", "Apr", "Mag", "Giu",
"Lug", "Ago", "Set", "Ott", "Nov", "Dic")
doucmenti_vendita <- doucmenti_vendita %>%
mutate(anno = year(ymd(data)),
mese = month(ymd(data)))
doucmenti_vendita <- doucmenti_vendita %>%
mutate(mese_testuale = nomi_mesi[mese])
doucmenti_vendita <- doucmenti_vendita %>%
mutate(data_formattata = paste(anno, mese_testuale, sep = "-"))
doucmenti_vendita <- doucmenti_vendita %>%
select(mesi, vendite ,data_formattata)
View(df)
View(doucmenti_vendita)
doucmenti_vendita <- doucmenti_vendita %>%
select(tipo, data ,costo, data_formattata)
View(doucmenti_vendita)
media_mesi = aggregate(documenti_vendita$costo, by = list(documenti_vendita$data_formattata), FUN=mean)
table(documenti_vendita$data_formattata)
media_mesi = aggregate(documenti_vendita$costo, by = list(documenti_vendita$data_formattata), FUN=mean)
#leggo i dati del file
nomeFile="Ordini.csv"
df=read.csv(nomeFile, sep= ",", header= FALSE)
#Aggiungi l’header al dataframe
colnames(df) <- c("tipo","data","costo")
summary(df)
table(df$tipo)
documenti_vendita <- subset(df, tipo=="FATTURA" | tipo=="RICEVUTA")
# getting all the dates in format "YYYYMM"
mesi <- substring(documenti_vendita$data, 1, 6)
#JOB 1
media_per_mese <- aggregate(documenti_vendita$costo, by = list(mesi), FUN = mean)
colnames(media_per_mese) <- c("mesi","vendite_medie")
nomi_mesi <- c("Gen", "Feb", "Mar", "Apr", "Mag", "Giu",
"Lug", "Ago", "Set", "Ott", "Nov", "Dic")
documenti_vendita <- documenti_vendita %>%
mutate(anno = year(ymd(data)),
mese = month(ymd(data)))
documenti_vendita <- documenti_vendita %>%
mutate(mese_testuale = nomi_mesi[mese])
documenti_vendita <- documenti_vendita %>%
mutate(data_formattata = paste(anno, mese_testuale, sep = "-"))
documenti_vendita <- documenti_vendita %>%
select(tipo, data ,costo, data_formattata)
media_mesi = aggregate(documenti_vendita$costo, by = list(documenti_vendita$data_formattata), FUN=mean)
View(media_mesi)
media_mesi = aggregate(documenti_vendita$costo, by = list(substr(documenti_vendita[,2], 1,6))), FUN=mean)
media_mesi = aggregate(documenti_vendita$costo, by = list(substr(documenti_vendita[,2], 1,6)), FUN=mean)
View(media_mesi)
#leggo i dati del file
nomeFile="Ordini.csv"
df=read.csv(nomeFile, sep= ",", header= FALSE)
#Aggiungi l’header al dataframe
colnames(df) <- c("tipo","data","costo")
summary(df)
table(df$tipo)
documenti_vendita <- subset(df, tipo=="FATTURA" | tipo=="RICEVUTA")
# getting all the dates in format "YYYYMM"
mesi <- substring(documenti_vendita$data, 1, 6)
#JOB 1
media_per_mese <- aggregate(documenti_vendita$costo, by = list(mesi), FUN = mean)
colnames(media_per_mese) <- c("data","vendite_medie")
nomi_mesi <- c("Gen", "Feb", "Mar", "Apr", "Mag", "Giu",
"Lug", "Ago", "Set", "Ott", "Nov", "Dic")
media_per_mese <- media_per_mese %>%
mutate(anno = year(ymd(data)),
mese = month(ymd(data)))
media_per_mese <- media_per_mese %>%
mutate(mese_testuale = nomi_mesi[mese])
media_per_mese <- media_per_mese %>%
mutate(data_formattata = paste(anno, mese_testuale, sep = "-"))
media_per_mese <- media_per_mese %>%
select(data ,vendite_medie, data_formattata)
nomeFile="Ordini.csv"
df=read.csv(nomeFile, sep= ",", header= FALSE)
#Aggiungi l’header al dataframe
colnames(df) <- c("tipo","data","costo")
summary(df)
table(df$tipo)
documenti_vendita <- subset(df, tipo=="FATTURA" | tipo=="RICEVUTA")
# getting all the dates in format "YYYYMM"
mesi <- substring(documenti_vendita$data, 1, 6)
#JOB 1
media_per_mese <- aggregate(documenti_vendita$costo, by = list(mesi), FUN = mean)
colnames(media_per_mese) <- c("data","vendite_medie")
nomi_mesi <- c("Gen", "Feb", "Mar", "Apr", "Mag", "Giu",
"Lug", "Ago", "Set", "Ott", "Nov", "Dic")
media_per_mese <- media_per_mese %>%
mutate(anno = year(ymd(data)),
mese = month(ymd(data)))
View(media_per_mese)
media_per_mese$data <- as.Date(media_per_mese$data, format = "%Y-%m")
media_per_mese <- media_per_mese %>%
mutate(anno = year(ymd(data)),
mese = month(ymd(data)))
View(media_mesi)
View(media_per_mese)
media_per_mese <- aggregate(documenti_vendita$costo, by = list(mesi), FUN = mean)
colnames(media_per_mese) <- c("data","vendite_medie")
View(media_per_mese)
media_per_mese$data <- as.Date(media_per_mese$data, format = "%Y-%m")
View(media_per_mese)
media_per_mese <- media_per_mese %>%
mutate(mese = substring(documenti_vendita$data, 4, 6))
View(media_per_mese)
media_per_mese <- aggregate(documenti_vendita$costo, by = list(mesi), FUN = mean)
colnames(media_per_mese) <- c("data","vendite_medie")
media_per_mese <- media_per_mese %>%
mutate(mese = substring(documenti_vendita$data, 4, 6))
media_per_mese <- media_per_mese %>%
mutate(mese = substring(documenti_vendita$data, 5, 6))
rlang::last_trace()
media_per_mese <- media_per_mese %>%
mutate(mese = substring(documenti_vendita$data, 5, 2))
df$mese <- substr(df$data, 5, 6)
View(df)
media_per_mese$mese <- substr(df$data, 5, 6)
media_per_mese <- media_per_mese %>%
mutate(mese = substring(media_per_mese$data, 5, 6))
View(media_per_mese)
media_per_mese <- media_per_mese %>%
mutate(mese_testuale = nomi_mesi[mese])
media_per_mese <- media_per_mese %>%
mutate(data_formattata = paste(anno, mese_testuale, sep = "-"))
media_per_mese$anno <- substr(media_per_mese$data, 1, 4)
media_per_mese <- media_per_mese %>%
mutate(data_formattata = paste(anno, mese_testuale, sep = "-"))
media_per_mese <- media_per_mese %>%
select(data ,vendite_medie, data_formattata)
View(media_per_mese)
nomi_mesi[01]
nomi_mesi <- c("Gen", "Feb", "Mar", "Apr", "Mag", "Giu",
"Lug", "Ago", "Set", "Ott", "Nov", "Dic")
media_per_mese <- media_per_mese %>%
mutate(mese = substring(media_per_mese$data, 5, 6))
media_per_mese$anno <- substr(media_per_mese$data, 1, 4)
media_per_mese <- media_per_mese %>%
mutate(mese_testuale = nomi_mesi[mese])
media_per_mese <- media_per_mese %>%
mutate(data_formattata = paste(anno, mese_testuale, sep = "-"))
View(media_per_mese)
media_per_mese <- media_per_mese %>%
mutate(mese_testuale = nomi_mesi[mese])
View(media_per_mese)
View(media_mesi)
path_attuale <- dirname(rstudioapi::getActiveDocumentContext()$path)
setwd(path_attuale)
library(lubridate)
library(dplyr)
#leggo i dati del file
nomeFile="Ordini.csv"
df=read.csv(nomeFile, sep= ",", header= FALSE)
#Aggiungi l’header al dataframe
colnames(df) <- c("tipo","data","costo")
summary(df)
table(df$tipo)
documenti_vendita <- subset(df, tipo=="FATTURA" | tipo=="RICEVUTA")
# getting all the dates in format "YYYYMM"
mesi <- substring(documenti_vendita$data, 1, 6)
#JOB 1
media_per_mese <- aggregate(documenti_vendita$costo, by = list(mesi), FUN = mean)
colnames(media_per_mese) <- c("data","vendite_medie")
nomi_mesi <- c("Gen", "Feb", "Mar", "Apr", "Mag", "Giu",
"Lug", "Ago", "Set", "Ott", "Nov", "Dic")
media_per_mese <- media_per_mese %>%
mutate(mese = substring(media_per_mese$data, 5, 6))
media_per_mese$anno <- substr(media_per_mese$data, 1, 4)
View(media_per_mese)
media_per_mese <- media_per_mese %>%
mutate(mese_testuale = nomi_mesi[mese])
media_per_mese <- media_per_mese %>%
mutate(mese_testuale = nomi_mesi[as.numeric(mese)])
media_per_mese <- media_per_mese %>%
mutate(data_formattata = paste(anno, mese_testuale, sep = "-"))
media_per_mese <- media_per_mese %>%
select(data ,vendite_medie, data_formattata)
grafico <- ggplot(media_per_mese, aes(x = data_formattata, y = vendite_medie)) +
geom_bar(stat = "identity", fill = "steelblue", position = position_dodge(width = 0.8)) +
labs(x = "ANNOMESE", y = "COSTO") + ggtitle("Medie per Mese") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 90, hjust = 1),
axis.text = element_text(margin = margin(t = 5, unit = "pt")))
varianza_mesi = aggregate(documenti_vendita$costo, by = list(mesi), FUN = var)
View(varianza_mesi)
somma_mesi = aggregate(documenti_vendita$costo, by = list(mesi), FUN = sum)
View(somma_mesi)
View(documenti_vendita)
View(media_per_mese)
View(somma_mesi)
somma_mesi = aggregate(documenti_vendita$costo, by = list(mesi), FUN = sum)
colnames(somma_mesi) <- c("data","vendite_totali")
mesi_max = merge(mesi_max_importoonly, somma_mesi,by="vendite_totali")
View(somma_mesi)
View(media_per_mese)
# Ottieni il percorso del file di script corrente
path_attuale <- dirname(rstudioapi::getActiveDocumentContext()$path)
setwd(path_attuale)
library(lubridate)
library(dplyr)
#leggo i dati del file
nomeFile="Ordini.csv"
df=read.csv(nomeFile, sep= ",", header= FALSE)
#Aggiungi l’header al dataframe
colnames(df) <- c("tipo","data","costo")
summary(df)
table(df$tipo)
documenti_vendita <- subset(df, tipo=="FATTURA" | tipo=="RICEVUTA")
# getting all the dates in format "YYYYMM"
mesi <- substring(documenti_vendita$data, 1, 6)
#JOB 1
media_mesi <- aggregate(documenti_vendita$costo, by = list(mesi), FUN = mean)
colnames(media_mesi) <- c("data","vendite_medie")
nomi_mesi <- c("Gen", "Feb", "Mar", "Apr", "Mag", "Giu",
"Lug", "Ago", "Set", "Ott", "Nov", "Dic")
media_mesi <- media_mesi %>%
mutate(mese = substring(media_mesi$data, 5, 6))
media_mesi$mese <- substr(media_mesi$data, 1, 4)
media_mesi <- media_mesi %>%
mutate(mese_testuale = nomi_mesi[as.numeric(mese)])
media_mesi <- media_mesi %>%
mutate(data_formattata = paste(anno, mese_testuale, sep = "-"))
View(media_mesi)
media_mesi$anno <- substr(media_mesi$data, 1, 4)
media_mesi <- media_mesi %>%
mutate(mese = substring(media_mesi$data, 5, 6))
media_mesi <- media_mesi %>%
mutate(mese_testuale = nomi_mesi[as.numeric(mese)])
media_mesi <- media_mesi %>%
mutate(data_formattata = paste(anno, mese_testuale, sep = "-"))
colnames(somma_mesi) <- c("data","vendite_totali")
somma_mesi$anno <- substr(somma_mesi$data, 1, 4)
anni <- somma_mesi$anno
mesi_max_importoonly = aggregate(somma_mesi$vendite_totali, by =list(anni), FUN=max)
View(mesi_max_importoonly)
mesi_max = merge(mesi_max_importoonly, somma_mesi,by="vendite_totali")
mesi_max = merge(mesi_max_importoonly, somma_mesi, by="vendite_totali")
colnames(mesi_max_importoonly) <- c("anno","vendite_totali")
mesi_max = merge(mesi_max_importoonly, somma_mesi, by="vendite_totali")
View(mesi_max)
mesi_min_importoonly = aggregate(somma_mesi$vendite_totali, by =list(anni), FUN=min)
colnames(mesi_min_importoonly) <- c("anno_di_riferimento","vendite_totali")
mesi_min = merge(mesi_min_importoonly, somma_mesi, by="vendite_totali")
View(mesi_min)
grafico <- ggplot(media_mesi, aes(x = data, y = vendite_medie)) +
geom_bar(stat = "identity", fill = "steelblue", position = position_dodge(width = 0.8)) +
labs(x = "ANNOMESE", y = "COSTO") + ggtitle("Medie per Mese") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 90, hjust = 1),
axis.text = element_text(margin = margin(t = 5, unit = "pt")))
install.packages("ggplot2")
library(ggplot2)
grafico <- ggplot(media_mesi, aes(x = data, y = vendite_medie)) +
geom_bar(stat = "identity", fill = "steelblue", position = position_dodge(width = 0.8)) +
labs(x = "ANNOMESE", y = "COSTO") + ggtitle("Medie per Mese") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 90, hjust = 1),
axis.text = element_text(margin = margin(t = 5, unit = "pt")))
View(grafico)
ggplot(media_mesi, aes(x = data, y = vendite_medie)) +
geom_bar(stat = "identity", fill = "steelblue", position = position_dodge(width = 0.8)) +
labs(x = "ANNOMESE", y = "COSTO") + ggtitle("Medie per Mese") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 90, hjust = 1),
axis.text = element_text(margin = margin(t = 5, unit = "pt")))
update.packages(checkBuilt = TRUE)
ggplot(media_mesi, aes(x = data, y = vendite_medie)) +
geom_bar(stat = "identity", fill = "steelblue", position = position_dodge(width = 0.8)) +
labs(x = "ANNOMESE", y = "COSTO") + ggtitle("Medie per Mese") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 90, hjust = 1),
axis.text = element_text(margin = margin(t = 5, unit = "pt")))
install.packages("labeling")
ggplot(media_mesi, aes(x = data, y = vendite_medie)) +
geom_bar(stat = "identity", fill = "steelblue", position = position_dodge(width = 0.8)) +
labs(x = "ANNOMESE", y = "COSTO") + ggtitle("Medie per Mese") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 90, hjust = 1),
axis.text = element_text(margin = margin(t = 5, unit = "pt")))
ggplot(media_mesi, aes(x = data, y = vendite_medie)) +
geom_bar(stat = "identity", fill = "steelblue", position = position_dodge(width = 0.8)) +
ggtitle("Medie per Mese") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 90, hjust = 1),
axis.text = element_text(margin = margin(t = 5, unit = "pt")))
View(mesi_max)
View(mesi_min)
View(mesi_min)
# Ottieni il percorso del file di script corrente
path_attuale <- dirname(rstudioapi::getActiveDocumentContext()$path)
setwd(path_attuale)
library(lubridate)
library(dplyr)
#leggo i dati del file
nomeFile="Ordini.csv"
df=read.csv(nomeFile, sep= ",", header= FALSE)
#Aggiungi l’header al dataframe
colnames(df) <- c("tipo","data","costo")
summary(df)
table(df$tipo)
documenti_vendita <- subset(df, tipo=="FATTURA" | tipo=="RICEVUTA")
# getting all the dates in format "YYYYMM"
mesi <- substring(documenti_vendita$data, 1, 6)
#JOB 1
media_mesi <- aggregate(documenti_vendita$costo, by = list(mesi), FUN = mean)
colnames(media_mesi) <- c("data","vendite_medie")
nomi_mesi <- c("Gen", "Feb", "Mar", "Apr", "Mag", "Giu",
"Lug", "Ago", "Set", "Ott", "Nov", "Dic")
media_mesi <- media_mesi %>%
mutate(mese = substring(media_mesi$data, 5, 6))
media_mesi$anno <- substr(media_mesi$data, 1, 4)
media_mesi <- media_mesi %>%
mutate(mese_testuale = nomi_mesi[as.numeric(mese)])
media_mesi <- media_mesi %>%
mutate(data_formattata = paste(anno, mese_testuale, sep = "-"))
media_mesi <- media_mesi %>%
select(data ,vendite_medie, data_formattata)
#JOB 2
varianza_mesi = aggregate(documenti_vendita$costo, by = list(mesi), FUN = var)
#JOB3
somma_mesi = aggregate(documenti_vendita$costo, by = list(mesi), FUN = sum)
colnames(somma_mesi) <- c("data","vendite_totali")
somma_mesi$anno <- substr(somma_mesi$data, 1, 4)
anni <- somma_mesi$anno
mesi_max_importo = aggregate(somma_mesi$vendite_totali, by =list(anni), FUN=max)
colnames(mesi_max_importo) <- c("anno_di_riferimento","vendite_totali")
mesi_max = merge(mesi_max_importo, somma_mesi, by="vendite_totali")
# Ottieni il percorso del file di script corrente
path_attuale <- dirname(rstudioapi::getActiveDocumentContext()$path)
setwd(path_attuale)
library(lubridate)
library(dplyr)
#leggo i dati del file
nomeFile="Ordini.csv"
df=read.csv(nomeFile, sep= ",", header= FALSE)
#Aggiungi l’header al dataframe
colnames(df) <- c("tipo","data","costo")
summary(df)
table(df$tipo)
documenti_vendita <- subset(df, tipo=="FATTURA" | tipo=="RICEVUTA")
# getting all the dates in format "YYYYMM"
mesi <- substring(documenti_vendita$data, 1, 6)
#JOB 1
media_mesi <- aggregate(documenti_vendita$costo, by = list(mesi), FUN = mean)
colnames(media_mesi) <- c("data","vendite_medie")
nomi_mesi <- c("Gen", "Feb", "Mar", "Apr", "Mag", "Giu",
"Lug", "Ago", "Set", "Ott", "Nov", "Dic")
media_mesi <- media_mesi %>%
mutate(mese = substring(media_mesi$data, 5, 6))
media_mesi$anno <- substr(media_mesi$data, 1, 4)
media_mesi <- media_mesi %>%
mutate(mese_testuale = nomi_mesi[as.numeric(mese)])
media_mesi <- media_mesi %>%
mutate(data_formattata = paste(anno, mese_testuale, sep = "-"))
media_mesi <- media_mesi %>%
select(data ,vendite_medie, data_formattata)
#JOB 2
varianza_mesi = aggregate(documenti_vendita$costo, by = list(mesi), FUN = var)
#JOB3
somma_mesi = aggregate(documenti_vendita$costo, by = list(mesi), FUN = sum)
colnames(somma_mesi) <- c("data","vendite_totali")
somma_mesi$anno <- substr(somma_mesi$data, 1, 4)
anni <- somma_mesi$anno
anni <- unique(somma_mesi$anno)
for (year in anni) {
# filtering all the months in the year
valori_anno <- df_date[which(startsWith(somma_mesi$data, year)), ]
# getting the month with the highest sale amount
max <- valori_anno[which.max(valori_anno$importo), ]
# writing output
cat(max$data, "\t", max$importo, "\n", sep = "")
}
for (year in anni) {
# filtering all the months in the year
valori_anno <- somma_mesi[which(startsWith(somma_mesi$data, year)), ]
# getting the month with the highest sale amount
max <- valori_anno[which.max(valori_anno$importo), ]
# writing output
cat(max$data, "\t", max$importo, "\n", sep = "")
}
for (year in anni) {
# filtering all the months in the year
valori_anno <- somma_mesi[which(startsWith(somma_mesi$data, year)), ]
# getting the month with the highest sale amount
max <- valori_anno[which.max(valori_anno$importo), ]
# writing output
print(max$data, "\t", max$importo, "\n", sep = "")
}
for (year in anni) {
# filtering all the months in the year
valori_anno <- somma_mesi[which(startsWith(somma_mesi$data, year)), ]
# getting the month with the highest sale amount
max <- valori_anno[which.max(valori_anno$importo), ]
# writing output
print(max$data+" "+max$importo)
}
for (year in anni) {
# filtering all the months in the year
valori_anno <- somma_mesi[which(startsWith(somma_mesi$data, year)), ]
# getting the month with the highest sale amount
max <- valori_anno[which.max(valori_anno$importo), ]
# writing output
print(max$data)
}
View(max)
View(max)
# Ottieni il percorso del file di script corrente
path_attuale <- dirname(rstudioapi::getActiveDocumentContext()$path)
setwd(path_attuale)
library(lubridate)
library(dplyr)
#leggo i dati del file
nomeFile="Ordini.csv"
df=read.csv(nomeFile, sep= ",", header= FALSE)
#Aggiungi l’header al dataframe
colnames(df) <- c("tipo","data","costo")
summary(df)
table(df$tipo)
documenti_vendita <- subset(df, tipo=="FATTURA" | tipo=="RICEVUTA")
# getting all the dates in format "YYYYMM"
mesi <- substring(documenti_vendita$data, 1, 6)
#JOB 1
media_mesi <- aggregate(documenti_vendita$costo, by = list(mesi), FUN = mean)
colnames(media_mesi) <- c("data","vendite_medie")
nomi_mesi <- c("Gen", "Feb", "Mar", "Apr", "Mag", "Giu",
"Lug", "Ago", "Set", "Ott", "Nov", "Dic")
media_mesi <- media_mesi %>%
mutate(mese = substring(media_mesi$data, 5, 6))
media_mesi$anno <- substr(media_mesi$data, 1, 4)
media_mesi <- media_mesi %>%
mutate(mese_testuale = nomi_mesi[as.numeric(mese)])
media_mesi <- media_mesi %>%
mutate(data_formattata = paste(anno, mese_testuale, sep = "-"))
media_mesi <- media_mesi %>%
select(data ,vendite_medie, data_formattata)
#JOB 2
varianza_mesi = aggregate(documenti_vendita$costo, by = list(mesi), FUN = var)
#JOB3
somma_mesi = aggregate(documenti_vendita$costo, by = list(mesi), FUN = sum)
colnames(somma_mesi) <- c("data","vendite_totali")
somma_mesi$anno <- substr(somma_mesi$data, 1, 4)
anni <- somma_mesi$anno
mesi_max_importo = aggregate(somma_mesi$vendite_totali, by =list(anni), FUN=max)
colnames(mesi_max_importo) <- c("anno_di_riferimento","vendite_totali")
mesi_max = merge(mesi_max_importo, somma_mesi, by="vendite_totali")
#JOB 4
mesi_min_importoonly = aggregate(somma_mesi$vendite_totali, by =list(anni), FUN=min)
colnames(mesi_min_importoonly) <- c("anno_di_riferimento","vendite_totali")
mesi_min = merge(mesi_min_importoonly, somma_mesi, by="vendite_totali")
library(ggplot2)
ggplot(media_mesi, aes(x = data, y = vendite_medie)) +
geom_bar(stat = "identity", fill = "steelblue", position = position_dodge(width = 0.8)) +
ggtitle("Medie per Mese") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 90, hjust = 1),
axis.text = element_text(margin = margin(t = 5, unit = "pt")))
View(media_mesi)
ggplot(media_mesi, aes(x = data, y = vendite_medie)) +
geom_bar(stat = "identity", fill = "steelblue", position = position_dodge(width = 0.8)) +
ggtitle("Medie per Mese") )
ggplot(media_mesi, aes(x = data, y = vendite_medie)) + geom_bar(stat = "identity", fill = "steelblue", position = position_dodge(width = 0.8)) + ggtitle("Medie per Mese")
